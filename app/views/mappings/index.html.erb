<% filtered_mappings = true if filtered_by_tags? || @path_contains.present? %>
<% title = filtered_mappings ? 'Filtered mappings' : 'Mappings' %>
<% content_for(:page_title, "#{title} | #{@site.default_host.hostname}") %>
<% breadcrumb(filtered_mappings ? :filtered_mappings : :mappings, @site) %>
<% saved_mappings = flash[:success] ? mappings_from_ids(flash[:success][:mapping_ids]) : false %>

<div class="page-title-with-border">
  <h1>
    <span class="small"><%= @site.default_host.hostname %></span>
    <%= title %>
  </h1>
</div>

<%= render partial: 'filters' %>

<h2>
  <%= pluralize(number_with_delimiter(@mappings.total_count), 'mapping') %>
</h2>
<% if filtered_by_tags? %>
  <section class="filtered-tags add-bottom-margin">
  <h3 class="rm">Tagged: </h3>
    <ul class="tag-list">
    <% filtered_by_tags.each do |tag| %>
      <li>
        <%= link_to remove_tag_from_filter_path(tag), class: 'tag', title: "Remove “#{tag}” tag filter" do %>
          <span class="glyphicon glyphicon-remove"></span> <%= tag %>
        <% end %>
      </li>
    <% end %>
    </ul>
  </section>
<% end%>

<% if @mappings.any? %>

  <%= paginate(@mappings) %>

  <%= render partial: 'mappings_table', locals:
      {
        site: @site,
        mappings: @mappings,
        include_edit_column: true,
        footer: true
      }
  %>

  <%= paginate(@mappings) %>

<% else %>
  <% if current_user.can_edit?(@site.organisation) %>
    <div class="add-bottom-margin">
      <%= render partial: 'add_button' %>
    </div>
  <% end %>
  <p class="no-content no-content-bordered">
    No mappings found
  </p>
<% end %>
